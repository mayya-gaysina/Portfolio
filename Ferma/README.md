# Проект "Прогнозирование удоя и "вкусности" молока"

Описание проекта

Обратился фермер, владелец молочного хозяйства «Вольный луг». Он хочет купить бурёнок, чтобы расширить поголовье стада коров. Для этого он заключил выгодный контракт с ассоциацией пастбищ «ЭкоФерма». Условия позволяют фермеру очень тщательно отобрать коров. Он определяет качество молока по строгой методике, и при этом ему нужно выполнять свой план развития молочного хозяйства. Фермер хочет, чтобы каждая бурёнка давала не менее 6000 килограммов молока в год, а её надой был вкусным — строго по его критериям, ничуть не хуже. Поэтому он просит разработать модель машинного обучения, которая поможет ему управлять рисками и принимать объективное решение о покупке. «ЭкоФерма» готова предоставить подробные данные о своих коровах.

Данные представлены 3-мя датасетами:
 - ferma_main.csv. Признаки представлены следующим группами: характеристики коровы (id, Порода, порода папы_быка, Возраст), характеристики корма (ЭКЕ (Энергетическая кормовая единица), Сырой протеин, г, СПО (Сахаро-протеиновое соотношение), характеристика пастбища (Тип пастбища), характеристики молока (Удой, кг, Жирность,%, Белок,%, Вкус молока).
 - ferma_dad.csv. Хранит имя папы каждой коровы в стаде фермера: id — уникальный идентификатор коровы, Имя Папы — имя папы коровы.
 - cow_buy.csv. Это данные о коровах «ЭкоФермы», которых фермер хочет изучить перед покупкой. Содержит почти те же данные, что и ferma_main.csv, но: содержание белков и жиров в молоке указано на момент продажи — когда «ЭкоФерма» давала коровам свой корм, параметры корма ЭКЕ (Энергетическая кормовая единица), Сырой протеин, г и СПО (Сахаро-протеиновое соотношение) отсутствуют. Технологи заказчика пересмотрели подход к кормлению: для новых коров планируется увеличить значения каждого из этих параметров на 5%. Кроме того, отсутствуют признаки Удой, кг и Вкус молока. Это целевые признаки, именно их предстоит предсказать!

В данном проекте необходимо решить следующие задачи:
 - нужно создать две прогнозные модели для отбора бурёнок в поголовье:
   - Первая будет прогнозировать возможный удой коровы (целевой признак Удой)
   - Вторая — рассчитывать вероятность получить вкусное молоко от коровы (целевой признак Вкус молока).
 - с помощью модели нужно отобрать коров по двум критериям:
   - средний удой за год — не менее 6000 килограммов;
   - молоко должно быть вкусным.

Структура проекта:
- изучение и предобработка данных,
- исследовательский анализ,
- корреляционный анализ признаков,
- задача регрессии,
- задача классификации,
- общий вывод


Для прогнозирования удоев и вкуса были обучены 2 модели соответственно: линейная регрессия и классификация. Выводы о моделях линейной регрессии и логистической регрессии:
 - регерессия:
    - для улучшения качества регрессионной модели использованы метод трансформации текущих входных признаков (для линейной регрессии - для устранения нелинейной зависимости), добавлены дополнительные неучтенные признаки (имена коров отцов);
    - поскольку анализ остатков в линейной модели показывает недостаточную "нормальность" распределения остатков, то модель может еще быть улучшена - возможно есть еще какие-то неучтенные дополнительные признаки (например, порода или имена матерей коров);
    -  корреляция удоев и возраста максимальная по сравнению с прочими признаками, но в данных от фермы коров с возрастом более 2-х лет почти в 5 раз больше, чем с возрастом менее 2-х лет - с учетом возраста выборка не совсем репрезентативна, при другом соотношении коров по возрасту модель может работать по-другому. Поэтому модель также может быть доработана при изменении соотношения коров по возрасту;
    -  оценка качества проведена путем ряда показателей:
       - значение коэф-та детерминации R2 - 0.88: 88% предсказаний модели ближе к истине, чем среднее значение удоев,
       - прогнозное значение удоя в среднем отличается от истинного на 145.6 кг,
       - распределение остатков является симметричным (модель даёт как завышенные, так и заниженные предсказания, которые «уравновешивают» друг друга),дисперсия остатков близка к постоянной
- классификация:
   - минимизированы ошибки 1-го рода, т.е. ошибочное признание молока вкусным: т.е. если молоко признано вкусным, то вероятность этого 100%. При этом ошибки 2-го рода, т.е. ошибочного признания молока невкусным, составляет 94%, т.е. вероятность признания вкусного молока невкусным и упустить корову с вкусным молоком крайне высокая.


Исходя из задачи с минимальным риском приобрести корову, которая гарантированно будет давать удои свыше 6000 кг и иметь вкусное молоко, из представленных данных Экофермы подходит только 10-я по списку корова:это корова породы РефлешнСоверинг,которая паслась на холмистом пастбище, порода отца - Айдал, кличка - Буйный, текущий процент жирности молока - 3.4%, процент белка в молоке - 3.08%, возрастом менее 2-х лет. При этом:
 - если удои свыше 6000 кг будут более важны, чем вкус: то подойдут все коровы, кроме 14-й по списку; если важно точно купить корову с вкусным молоком, невзирая, на уровень удоя, то подойдут 10-я и 14-я коровы.
 - если при удоях свыше 6000 кг требуется купить более одной коровы с вкусным молоком (например, три коровы): в этом случае можно купить 10-ю корову со 100%-ной вероятностью получения вкусного молока, а также купить 1-ю и 7-ю корову по списку и попросить по ним скидку, т.к. вероятность получения от них вкусного молока наиболее велика, но тем не менее не 100%-ная,
 - если станет важнее не упустить корову с вкусным молоком (снизить ошибки 2-го рода до нуля), то порог для отнесения к вкусному молоку нужно будет снизить до 0.25; если важно как можно точнее определить будет ли молоко вкусным или нет - порог нужно установить в 0.41.


